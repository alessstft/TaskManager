### Task Manager

**Общая цель:**  
Цель проекта, создать удобное легковесное приложение, которое позволяет посмотреть системные данные, как потоки, службы нагруженность ЦП, память на диске и т. д. Взаимодействие с приложением будет происходить через графический интерфейс.

**Функциональные возможности системы:**

1. **Вывод данных:**  
    Система выводит данные о компьютере (процессы, службы, производительность) в окна в графическом интерфейсе.
    
2. **Завершение процесса:**  
    Реализована возможность убить процесс и остановить его выполнение.
    
3. **Детализованные данные:**  
    Реализована возможность нажать на кнопки в окне "Производительность", чтобы получить более подробные данные о системе.
    
## Описание зависимостей

1. **Python 3.9+**
    - Основной язык разработки. Версия 3.9 или выше обеспечивает поддержку всех необходимых функций и библиотек.
    
2. **Windows Api 0.3**
    - Набор базовых функций интерфейсов программирование приложений операционных систем семейств Microsoft Windows. 
    - Предоставляет прямой способ взаимодействия приложений пользователя с операционной системой _Windows_.
    
3. **sysinfo 0.29**
    - Rонтейнер, используемый для получения информации о системе.

4. **Serde 1.9:**
    - Фреймворк для эффективной и универсальной сериализации и десериализации структур данных Rust.

**5. serde_json 1.0**  
- Высокопроизводительная библиотека для работы с JSON в Rust.  
- Обеспечивает парсинг и генерацию JSON-данных.  
- Используется для сериализации и десериализации данных о процессах и системной информации.

**6. lazy_static 1.4**  
- Макрос для Rust, позволяющий инициализировать статические переменные с ленивой инициализацией.  

**7. libc 0.2**  
- Rust-биндинги к библиотеке libc, предоставляющие низкоуровневый интерфейс к API операционной системы.  

**8. num_cpus 1.15**  
- Простая библиотека для определения количества CPU в системе.  
- Предоставляет информацию о количестве физических и логических процессоров.  

**9. ctypes**  
- Стандартная библиотека Python для работы с C-совместимыми типами данных.  
- Позволяет вызывать функции из динамических библиотек и взаимодействовать с кодом на C.  

**10. tkinter**  
- Стандартная графическая библиотека Python для создания кроссплатформенных GUI-приложений.  
- Используется как основа графического интерфейса Task Manager.

## Описание функций
###  Модуль DLL - Функции для статической информации

 **№1 `get_cpu_static_info()`**
pub extern "C" fn get_cpu_static_info() -> *mut CpuStaticInfo
- **Аргументы**: Нет.
- **Возвращает**: Указатель (`*mut CpuStaticInfo`) на структуру с данными о CPU.
- **Назначение**:
    - Собирает статическую информацию о процессоре:
        - **Модель** (`brand`) — название CPU (например, "Intel Core i7").
        - **Загрузку** (`usage`) — текущую загрузку в процентах.
        - **Частоту** (`frequency`) — тактовую частоту в ГГц.
        - **Время работы** (`work_time`) — аптайм системы в секундах.
        - **Количество процессов** (`process`) — общее число запущенных процессов.
        - **Количество ядер** (`core_count`) — физических ядер CPU.
    - Возвращает данные в виде сырого указателя для совместимости с FFI

 **№2 `free_cpu_static_info()`**
```
pub extern "C" fn free_cpu_static_info(info: *mut CpuStaticInfo)
```
- **Аргумент**:
    - `info` — указатель на структуру `CpuStaticInfo`, которую нужно освободить.
- **Возвращает**: Ничего.
- **Назначение**:
    1. Освобождает память, выделенную под структуру `CpuStaticInfo` (включая строку `brand`).

**№3 `internal_get_ram_info()`**
```
fn internal_get_ram_info() -> Result<Vec<MemoryInfo>, Box<dyn std::error::Error>>
```
- **Аргументы**: Нет.
- **Возвращает**:
    - `Ok(Vec<MemoryInfo>)` — вектор с данными о RAM (скорость, тип памяти).
    - `Err` — в случае ошибки выполнения PowerShell-команды или парсинга JSON.
- **Назначение**:
    1. Запускает PowerShell-команду для получения информации о физической памяти (`Win32_PhysicalMemory`).
    2. Парсит JSON-ответ, содержащий:
        - **Скорость** (`speed`) — частота памяти в МГц.
        - **Тип памяти** (`memory_format`) — строковое описание (например, "DDR4").
    3. Конвертирует данные в структуру `MemoryInfo` для передачи через FFI.

**№4 `get_ram_info_array()`**
```
pub extern "C" fn get_ram_info_array() -> MemoryInfoArray
```
- **Аргументы**: Нет.
- **Возвращает**:
    - Структуру `MemoryInfoArray`, содержащую:
        - `data` — указатель на массив структур `MemoryInfo` (скорость и тип памяти).
        - `len` — количество элементов в массиве.
    - В случае ошибки возвращает `MemoryInfoArray` с `data = null` и `len = 0`.
- **Назначение**:
    1. Вызывает внутреннюю функцию `internal_get_ram_info()` для получения данных о RAM.
    2. Конвертирует вектор (`Vec<MemoryInfo>`) в FFI-совместимую структуру:

**№5 `free_memory_info_array()`**
```
pub extern "C" fn free_memory_info_array(array: MemoryInfoArray)
```
- **Аргумент**:
    - `array` — структура `MemoryInfoArray`, которую нужно освободить.
- **Возвращает**: Ничего.
- **Назначение**:
    Освобождает память, выделенную под массив `MemoryInfo`:

**№6 `get_modern_memory_format()`**
```
fn get_modern_memory_format(smbios: Option<u32>, memory_type: Option<u32>) -> &'static str
```
- **Аргументы**:
    - `smbios` — опциональный тип памяти из SMBIOS (более современный стандарт).
    - `memory_type` — опциональный тип памяти из устаревшего API Windows.
- **Возвращает**:
    - Строку (`&'static str`) с названием формата памяти (например, `"DDR4"`).
    - `"Unknown"`, если тип не распознан.
- **Назначение**:
    1. Определяет тип памяти по значению из SMBIOS или старого API:
    2. Возвращает удобочитаемое название формата.

**№7 `get_memory_static_info()`**
```
pub extern "C" fn get_memory_static_info() -> MemoryStaticInfo
```
- **Аргументы**: Нет
- **Возвращает**: Структуру `MemoryStaticInfo` с информацией о RAM
- **Назначение**:
    1. Собирает актуальные данные о памяти с помощью `sysinfo`
    2. Возвращает структуру с:
        - Общим объемом памяти (`total`) в ГБ
        - Используемым объемом (`used`) в ГБ
        - Доступным объемом (`available`) в ГБ
        - Скоростью памяти (`speed`) в МГц
        - Типом памяти (`format`) в виде строки (DDR3/DDR4 и т.д.)

**№8 `get_disk_static_info_array()`**
```
pub extern "C" fn get_disk_static_info_array() -> DiskStaticInfoArray
```
- **Аргументы**: Нет
- **Возвращает**: Структуру `DiskStaticInfoArray` с массивом данных о дисках
- **Назначение**:
    1. Собирает информацию о всех физических дисках. Для каждого диска возвращает:
        - Имя диска (`name`)
        - Общий объем (`total_space`) в ГБ
        - Доступное пространство (`available_space`) в ГБ
    2. Упаковывает данные в FFI-совместимую структуру

**№9 `free_disk_static_info_array()`**
```
pub extern "C" fn free_disk_static_info_array(array: DiskStaticInfoArray)
```
- **Аргумент**: Структура `DiskStaticInfoArray` для освобождения
- **Возвращает**: Ничего
- **Назначение**:
    Освобождает память, выделенную под массив информации о дисках

**№10 `get_networks_static_info_array()`**
```
pub extern "C" fn get_networks_static_info_array() -> NetworksStaticInfoArray
```
- **Аргументы**: Нет
- **Возвращает**: Структура `NetworksStaticInfoArray` содержащая:
	- `data` - указатель на массив структур `NetworksStaticInfo`
	- `len` - количество элементов в массиве
- **Назначение **:
	 -Получение локального IP
    - При ошибке возвращает "0.0.0.0"
    - Возвращает все сетевые интерфейсы


### Модуль DLL - Функции для подбора информации о процессах

**№12 `start_process_collector()`**
```
pub extern "C" fn start_process_collector() -> bool
```
#### **Аргументы**: Нет
#### **Возвращаемое значение**:
- `true` - если поток успешно запущен
- `false` - если поток уже был запущен ранее
#### **Назначение**:
	Запускает фоновый поток для периодического сбора информации о процессах.

**№13 `get_process_info_array()`**
```
pub extern "C" fn get_process_info_array() -> ProcessInfoArray
```
#### **Аргументы**: Нет
#### **Возвращаемое значение**:
	Структура `ProcessInfoArray` содержащая:
		- `data` - указатель на массив структур `ProcessInfo`
		- `len` - количество элементов
#### **Назначение**:
	Возвращает текущий снимок информации о процессах.

 **№14 `stop_process_collector()`**
```
pub extern "C" fn stop_process_collector() -> bool
```
#### **Аргументы**: Нет
#### **Возвращаемое значение**:
	- `true` - если сборщик был успешно остановлен
	- `false` - если сборщик не был запущен
#### **Назначение**:
	Корректно останавливает фоновый сбор информации.

**№16 `free_process_info_array()`**
```
pub extern "C" fn free_process_info_array(array: ProcessInfoArray)
```
#### **Назначение**: Безопасно освобождает память, выделенную для массива данных о процессах.
#### **Аргументы**:
	- `array`: Структура `ProcessInfoArray`, содержащая указатель на массив и его длину
#### **Возвращает**:
	- Ничего

**№17 `kill_process()`**
```
pub extern "C" fn kill_process(pid: u32) -> i32
```
#### **Аргументы**
- `pid`: Идентификатор процесса (32-битное беззнаковое целое)
#### **Возвращает**:
	- `0` — успешное завершение
	- `-1` — ошибка открытия процесса (неверный PID или недостаточно прав)
	- `-2` — ошибка завершения процесса
#### **Назначение**
Принудительно завершает процесс по его идентификатору (PID) через Windows API.

**№18 `get_services_info_array()`**
```
#[cfg(target_os = "windows")]
pub extern "C" fn get_services_info_array() -> ServiceInfoArray
```
#### **Назначение**: Получает информацию о всех системных сервисах Windows через WMI (Windows Management Instrumentation).
#### **Аргументы**: - Нет
#### **Возвращаемое значение**:
	Структура `ServiceInfoArray`:
		- `data` - указатель на массив структур `ServiceInfo`
		- `len` - количество элементов в массиве

###  Модуль структуры
Созданы структуры для передачи данных о системе, сейчас эти структуры будут описаваться.

####  class ProcessInfo(Structure)
- pid - c-строка, которая обозначает ID процесса
- name - c-строка, которая обозначает имя процесса
- cpu_usage - дробное число, которое обозначает, какой процент мощности ЦП использует процесс
- memory_mb - double число, которое обозначает объем памяти, который процесс использует от ОП
- read_kb - double число, которое обозначает сколько памяти процесс требует от диска для чтение
- written_kb - double число, которое обозначает сколько памяти проецесс требует от диска для чтение

###  Модуль system_monitor - Соединение DLL и GUI
